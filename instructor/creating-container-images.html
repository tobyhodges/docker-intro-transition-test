<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Reproducible Computational Environments Using Containers: Introduction to Docker: Creating Your Own Container Images</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><abbr class="icon" title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team." style="text-decoration: unset">
          Â 
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link" style="color: #383838">Beta
            <i aria-hidden="true" class="icon" data-feather="alert-circle" style="color: #001483; border-radius: 5px"></i>
          </a>
          <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      <div class="beta-alert alert alert-light alert-dismissable fade show" role="alert">
        
        
        
        <i aria-hidden="true" class="icon" data-feather="alert-circle" style="color: #5bbad5"></i>
        
        Workbench Beta |
        <a href="https://carpentries.typeform.com/to/KRBl4IZM" class="external-link alert-link" style="text-decoration: wavy overline">Give Feedback</a> |
        <a href="https://carpentries.github.io/workbench/beta-phase.html" class="external-link alert-link">Learn More</a>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../creating-container-images.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Reproducible Computational Environments Using Containers: Introduction to Docker
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Reproducible Computational Environments Using Containers: Introduction to Docker
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="06-containers-on-the-cloud.html">Creating Containers on the Cloud</a></li><li><a class="dropdown-item" href="08-orchestration.html">Container Orchestration</a></li><li><a class="dropdown-item" href="e01-github-actions.html">Using Docker with Github Actions</a></li><li><a class="dropdown-item" href="e02-jekyll-lesson-example.html">Using Docker with Jekyll - Containers Used in Generating this Lesson</a></li>
          </ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Reproducible Computational Environments Using Containers: Introduction to Docker
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 40%" class="percentage">
    40%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 40%" aria-valuenow="40" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../creating-container-images.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Introducing Containers</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="meet-docker.html">2. Introducing the Docker Command Line</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="running-containers.html">3. Exploring and Running Containers</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="managing-containers.html">4. Cleaning Up Containers</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="docker-hub.html">5. Finding Containers on Docker Hub</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        6. Creating Your Own Container Images
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#interactive-installation">Interactive installation</a></li>
<li><a href="#put-installation-instructions-in-a-dockerfile">Put installation instructions in a <code>Dockerfile</code></a></li>
<li><a href="#create-a-new-docker-image">Create a new Docker image</a></li>
<li><a href="#boring-but-important-notes-about-installation">Boring but important notes about installation</a></li>
<li><a href="#share-your-new-container-image-on-docker-hub">Share your new container image on Docker Hub</a></li>
<li><a href="#whats-in-a-name-again">Whatâs in a name? (again)</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="advanced-containers.html">7. Creating More Complex Container Images</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="docker-image-examples.html">8. Examples of Using Container Images in Practice</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="reproduciblity.html">9. Containers in Research Workflows: Reproducibility and Granularity</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <li><a href="06-containers-on-the-cloud.html">Creating Containers on the Cloud</a></li><li><a href="08-orchestration.html">Container Orchestration</a></li><li><a href="e01-github-actions.html">Using Docker with Github Actions</a></li><li><a href="e02-jekyll-lesson-example.html">Using Docker with Jekyll - Containers Used in Generating this Lesson</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/docker-hub.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/advanced-containers.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/docker-hub.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Finding Containers
        </a>
        <a class="chapter-link float-end" href="../instructor/advanced-containers.html" rel="next">
          Next: Creating More... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Creating Your Own Container Images</h1>
        <p> Last updated on 2023-10-25 | 
        
        <a href="https://github.com/fishtree-attempt/docker-introduction/edit/main/episodes/creating-container-images.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 35 minutes </p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can I make my own Docker container images?</li>
<li>How do I document the ârecipeâ for a Docker container image?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Explain the purpose of a <code>Dockerfile</code> and show some
simple examples.</li>
<li>Demonstrate how to build a Docker container image from a
<code>Dockerfile</code>.</li>
<li>Compare the steps of creating a container image interactively versus
a <code>Dockerfile</code>.</li>
<li>Create an installation strategy for a container image.</li>
<li>Demonstrate how to upload (âpushâ) your container images to the
Docker Hub.</li>
<li>Describe the significance of the Docker Hub naming scheme.</li>
</ul></div>
</div>
</div>
</div>
</div>
<p>There are lots of reasons why you might want to create your
<strong>own</strong> Docker container image.</p>
<ul><li>You canât find a container image with all the tools you need on
Docker Hub.</li>
<li>You want to have a container image to âarchiveâ all the specific
software versions you ran for a project.</li>
<li>You want to share your workflow with someone else.</li>
</ul><section id="interactive-installation"><h2 class="section-heading">Interactive installation<a class="anchor" aria-label="anchor" href="#interactive-installation"></a>
</h2>
<hr class="half-width"><p>Before creating a reproducible installation, letâs experiment with
installing software inside a container. Start a container from the
<code>alpine</code> container image we used before, interactively:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> docker container run <span class="at">-it</span> alpine sh</span></code></pre>
</div>
<p>Because this is a basic container, thereâs a lot of things not
installed â for example, <code>python3</code>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/#</span> python3</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>sh: python3: not found</code></pre>
</div>
<p>Inside the container, we can run commands to install Python 3. The
Alpine version of Linux has a installation tool called <code>apk</code>
that we can use to install Python 3.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/#</span> apk add <span class="at">--update</span> python3 py3-pip python3-dev</span></code></pre>
</div>
<p>We can test our installation by running a Python command:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/#</span> python3 <span class="at">--version</span></span></code></pre>
</div>
<p>Once Python is installed, we can add Python packages using the pip
package installer:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/#</span> pip install cython</span></code></pre>
</div>
<div id="exercise-searching-for-help" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-searching-for-help" class="callout-inner">
<h3 class="callout-title">Exercise: Searching for Help<a class="anchor" aria-label="anchor" href="#exercise-searching-for-help"></a>
</h3>
<div class="callout-content">
<p>Can you find instructions for installing R on Alpine Linux? Do they
work?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>A quick search should hopefully show that the way to install R on
Alpine Linux is:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/#</span> apk add R</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Once we exit, these changes are not saved to a new container image by
default. There is a command that will âsnapshotâ our changes, but
building container images this way is not easily reproducible. Instead,
weâre going to take what weâve learned from this interactive
installation and create our container image from a reproducible recipe,
known as a <code>Dockerfile</code>.</p>
<p>If you havenât already, exit out of the interactively running
container.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/#</span> exit</span></code></pre>
</div>
</section><section id="put-installation-instructions-in-a-dockerfile"><h2 class="section-heading">Put installation instructions in a <code>Dockerfile</code><a class="anchor" aria-label="anchor" href="#put-installation-instructions-in-a-dockerfile"></a>
</h2>
<hr class="half-width"><p>A <code>Dockerfile</code> is a plain text file with keywords and
commands that can be used to create a new container image.</p>
<p>From your shell, go to the folder you downloaded at the start of the
lesson and print out the Dockerfile inside:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd ~/Desktop/docker-intro/basic</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat Dockerfile</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>FROM &lt;EXISTING IMAGE&gt;
RUN &lt;INSTALL CMDS FROM SHELL&gt;
RUN &lt;INSTALL CMDS FROM SHELL&gt;
CMD &lt;CMD TO RUN BY DEFAULT&gt;</code></pre>
</div>
<p>Letâs break this file down:</p>
<ul><li>The first line, <code>FROM</code>, indicates which container image
weâre starting with. It is the âbaseâ container image we are going to
start from.</li>
<li>The next two lines <code>RUN</code>, will indicate installation
commands we want to run. These are the same commands that we used
interactively above.</li>
<li>The last line, <code>CMD</code>, indicates the default command we
want a container based on this container image to run, if no other
command is provided. It is recommended to provide <code>CMD</code> in
<em>exec-form</em> (see the <a href="https://docs.docker.com/engine/reference/builder/#cmd" class="external-link"><code>CMD</code>
section</a> of the Dockerfile documentation for more details). It is
written as a list which contains the executable to run as its first
element, optionally followed by any arguments as subsequent elements.
The list is enclosed in square brackets (<code>[]</code>) and its
elements are double-quoted (<code>"</code>) strings which are separated
by commas. For example,
<code>CMD ["ls", "-lF", "--color", "/etc"]</code> would translate to
<code>ls -lF --color /etc</code>.</li>
</ul><div id="shell-form-and-exec-form-for-cmd" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="shell-form-and-exec-form-for-cmd" class="callout-inner">
<h3 class="callout-title">
<em>shell-form</em> and <em>exec-form</em> for
CMD<a class="anchor" aria-label="anchor" href="#shell-form-and-exec-form-for-cmd"></a>
</h3>
<div class="callout-content">
<p>Another way to specify the parameter for the <a href="https://docs.docker.com/engine/reference/builder/#cmd" class="external-link"><code>CMD</code>
instruction</a> is the <em>shell-form</em>. Here you type the command as
you would call it from the command line. Docker then silently runs this
command in the imageâs standard shell. <code>CMD cat /etc/passwd</code>
is equivalent to <code>CMD ["/bin/sh", "-c", "cat /etc/passwd"]</code>.
We recommend to prefer the more explicit <em>exec-form</em> because we
will be able to create more flexible container image command options and
make sure complex commands are unambiguous in this format.</p>
</div>
</div>
</div>
<div id="exercise-take-a-guess" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-take-a-guess" class="callout-inner">
<h3 class="callout-title">Exercise: Take a Guess<a class="anchor" aria-label="anchor" href="#exercise-take-a-guess"></a>
</h3>
<div class="callout-content">
<p>Do you have any ideas about what we should use to fill in the sample
Dockerfile to replicate the installation we did above?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Solution:
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Based on our experience above, edit the <code>Dockerfile</code> (in
your text editor of choice) to look like this:</p>
<pre><code>FROM alpine
RUN apk add --update python3 py3-pip python3-dev
RUN pip install cython
CMD ["python3", "--version"]</code></pre>
</div>
</div>
</div>
</div>
<p>The recipe provided by the <code>Dockerfile</code> shown in the
solution to the preceding exercise will use Alpine Linux as the base
container image, add Python 3 and the Cython library, and set a default
command to request Python 3 to report its version information.</p>
</section><section id="create-a-new-docker-image"><h2 class="section-heading">Create a new Docker image<a class="anchor" aria-label="anchor" href="#create-a-new-docker-image"></a>
</h2>
<hr class="half-width"><p>So far, we only have a text file named <code>Dockerfile</code> â we
do not yet have a container image. We want Docker to take this
<code>Dockerfile</code>, run the installation commands contained within
it, and then save the resulting container as a new container image. To
do this we will use the <code>docker image build</code> command.</p>
<p>We have to provide <code>docker image build</code> with two pieces of
information:</p>
<ul><li>the location of the <code>Dockerfile</code>
</li>
<li>the name of the new container image. Remember the naming scheme from
before? You should name your new image with your Docker Hub username and
a name for the container image, like this:
<code>USERNAME/CONTAINER_IMAGE_NAME</code>.</li>
</ul><p>All together, the build command that you should run on your computer,
will have a similar structure to this:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> docker image build <span class="at">-t</span> USERNAME/CONTAINER_IMAGE_NAME .</span></code></pre>
</div>
<p>The <code>-t</code> option names the container image; the final dot
indicates that the <code>Dockerfile</code> is in our current
directory.</p>
<p>For example, if my user name was <code>alice</code> and I wanted to
call my container image <code>alpine-python</code>, I would use this
command:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> docker image build <span class="at">-t</span> alice/alpine-python .</span></code></pre>
</div>
<div id="build-context" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="build-context" class="callout-inner">
<h3 class="callout-title">Build Context<a class="anchor" aria-label="anchor" href="#build-context"></a>
</h3>
<div class="callout-content">
<p>Notice that the final input to <code>docker image build</code> isnât
the Dockerfile â itâs a directory! In the command above, weâve used the
current working directory (<code>.</code>) of the shell as the final
input to the <code>docker image build</code> command. This option
provides what is called the <em>build context</em> to Docker â if there
are files being copied into the built container image <a href="../advanced-containers">more details in the next episode</a> theyâre
assumed to be in this location. Docker expects to see a Dockerfile in
the build context also (unless you tell it to look elsewhere).</p>
<p>Even if it wonât need all of the files in the build context
directory, Docker does âloadâ them before starting to build, which means
that itâs a good idea to have only what you need for the container image
in a build context directory, as weâve done in this example.</p>
</div>
</div>
</div>
<div id="exercise-review" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-review" class="callout-inner">
<h3 class="callout-title">Exercise: Review!<a class="anchor" aria-label="anchor" href="#exercise-review"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li><p>Think back to earlier. What command can you run to check if your
container image was created successfully? (Hint: what command shows the
container images on your computer?)</p></li>
<li><p>We didnât specify a tag for our container image name. What tag
did Docker automatically use?</p></li>
<li><p>What command will run a container based on the container image
youâve created? What should happen by default if you run such a
container? Can you make it do something different, like print âhello
worldâ?</p></li>
</ol></div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li><p>To see your new image, run <code>docker image ls</code>. You
should see the name of your new container image under the âREPOSITORYâ
heading.</p></li>
<li><p>In the output of <code>docker image ls</code>, you can see that
Docker has automatically used the <code>latest</code> tag for our new
container image.</p></li>
<li><p>We want to use <code>docker container run</code> to run a
container based on a container image.</p></li>
</ol><p>The following command should run a container and print out our
default message, the version of Python:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> docker container run alice/alpine-python</span></code></pre>
</div>
<p>To run a container based on our container image and print out âHello
worldâ instead:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> docker container run alice/alpine-python echo <span class="st">"Hello World"</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>While it may not look like you have achieved much, you have already
effected the combination of a lightweight Linux operating system with
your specification to run a given command that can operate reliably on
macOS, Microsoft Windows, Linux and on the cloud!</p>
</section><section id="boring-but-important-notes-about-installation"><h2 class="section-heading">Boring but important notes about installation<a class="anchor" aria-label="anchor" href="#boring-but-important-notes-about-installation"></a>
</h2>
<hr class="half-width"><p>There are a lot of choices when it comes to installing software â
sometimes too many! Here are some things to consider when creating your
own container image:</p>
<ul><li>
<strong>Start smart</strong>, or, donât install everything from
scratch! If youâre using Python as your main tool, start with a <a href="https://hub.docker.com/_/python" class="external-link">Python container image</a>. Same
with <a href="https://hub.docker.com/r/rocker/r-ver/" class="external-link">R</a>. Weâve used
Alpine Linux as an example in this lesson, but itâs generally not a good
container image to start with for initial development and
experimentation because it is a less common distribution of Linux; using
<a href="https://hub.docker.com/_/ubuntu" class="external-link">Ubuntu</a>, <a href="https://hub.docker.com/_/debian" class="external-link">Debian</a> and <a href="https://hub.docker.com/_/centos" class="external-link">CentOS</a> are all good options
for scientific software installations. The program youâre using might
recommend a particular distribution of Linux, and if so, it may be
useful to start with a container image for that distribution.</li>
<li>
<strong>How big?</strong> How much software do you really need to
install? When you have a choice, lean towards using smaller starting
container images and installing only whatâs needed for your software, as
a bigger container image means longer download times to use.</li>
<li>
<strong>Know (or Google) your Linux</strong>. Different
distributions of Linux often have distinct sets of tools for installing
software. The <code>apk</code> command we used above is the software
package installer for Alpine Linux. The installers for various common
Linux distributions are listed below:
<ul><li>Ubuntu: <code>apt</code> or <code>apt-get</code>
</li>
<li>Debian: <code>deb</code>
</li>
<li>CentOS: <code>yum</code> Most common software installations are
available to be installed via these tools. A web search for âinstall X
on Y Linuxâ is usually a good start for common software installation
tasks; if something isnât available via the Linux distributionâs
installation tools, try the options below.</li>
</ul></li>
<li>
<strong>Use what you know</strong>. Youâve probably used commands
like <code>pip</code> or <code>install.packages()</code> before on your
own computer â these will also work to install things in container
images (if the basic scripting language is installed).</li>
<li>
<strong>README</strong>. Many scientific software tools have a
README or installation instructions that lay out how to install
software. You want to look for instructions for Linux. If the install
instructions include options like those suggested above, try those
first.</li>
</ul><p>In general, a good strategy for installing software is:</p>
<ul><li>Make a list of what you want to install.</li>
<li>Look for pre-existing container images.</li>
<li>Read through instructions for software youâll need to install.</li>
<li>Try installing everything interactively in your base container â
take notes!</li>
<li>From your interactive installation, create a <code>Dockerfile</code>
and then try to build the container image from that.</li>
</ul></section><section id="share-your-new-container-image-on-docker-hub"><h2 class="section-heading">Share your new container image on Docker Hub<a class="anchor" aria-label="anchor" href="#share-your-new-container-image-on-docker-hub"></a>
</h2>
<hr class="half-width"><p>Container images that you release publicly can be stored on the
Docker Hub for free. If you name your container image as described
above, with your Docker Hub username, all you need to do is run the
opposite of <code>docker image pull</code> â
<code>docker image push</code>.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> docker image push alice/alpine-python</span></code></pre>
</div>
<p>Make sure to substitute the full name of your container image!</p>
<p>In a web browser, open <a href="https://hub.docker.com" class="external-link">https://hub.docker.com</a>, and on your
user page you should now see your container image listed, for anyone to
use or build on.</p>
<div id="logging-in" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="logging-in" class="callout-inner">
<h3 class="callout-title">Logging In<a class="anchor" aria-label="anchor" href="#logging-in"></a>
</h3>
<div class="callout-content">
<p>Technically, you have to be logged into Docker on your computer for
this to work. Usually it happens by default, but if
<code>docker image push</code> doesnât work for you, run
<code>docker login</code> first, enter your Docker Hub username and
password, and then try <code>docker image push</code> again.</p>
</div>
</div>
</div>
</section><section id="whats-in-a-name-again"><h2 class="section-heading">Whatâs in a name? (again)<a class="anchor" aria-label="anchor" href="#whats-in-a-name-again"></a>
</h2>
<hr class="half-width"><p>You donât <em>have</em> to name your containers images using the
<code>USERNAME/CONTAINER_IMAGE_NAME:TAG</code> naming scheme. On your
own computer, you can call container images whatever you want, and refer
to them by the names you choose. Itâs only when you want to share a
container image that it needs the correct naming format.</p>
<p>You can rename container images using the
<code>docker image tag</code> command. For example, imagine someone
named Alice has been working on a workflow container image and called it
<code>workflow-test</code> on her own computer. She now wants to share
it in her <code>alice</code> Docker Hub account with the name
<code>workflow-complete</code> and a tag of <code>v1</code>. Her
<code>docker image tag</code> command would look like this:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> docker image tag workflow-test alice/workflow-complete:v1</span></code></pre>
</div>
<p>She could then push the re-named container image to Docker Hub, using
<code>docker image push alice/workflow-complete:v1</code></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>
<code>Dockerfile</code>s specify what is within Docker container
images.</li>
<li>The <code>docker image build</code> command is used to build a
container image from a <code>Dockerfile</code>.</li>
<li>You can share your Docker container images through the Docker Hub so
that others can create Docker containers from your container
images.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/docker-hub.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/advanced-containers.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/docker-hub.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Finding Containers
        </a>
        <a class="chapter-link float-end" href="../instructor/advanced-containers.html" rel="next">
          Next: Creating More... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/fishtree-attempt/docker-introduction/edit/main/episodes/creating-container-images.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/fishtree-attempt/docker-introduction/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/fishtree-attempt/docker-introduction/" class="external-link">Source</a></p>
				<p><a href="https://github.com/fishtree-attempt/docker-introduction/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:docker-introduction+admins@lists.carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="../LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.14.1" class="external-link">sandpaper (0.14.1)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/0.7.1" class="external-link">pegboard (0.7.1)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.3.3" class="external-link">varnish (0.3.3)</a>.</p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://preview.carpentries.org/docker-introduction/instructor/creating-container-images.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Creating Your Own Container Images",
  "creativeWorkStatus": "active",
  "url": "https://preview.carpentries.org/docker-introduction/instructor/creating-container-images.html",
  "identifier": "https://preview.carpentries.org/docker-introduction/instructor/creating-container-images.html",
  "dateCreated": "2019-08-07",
  "dateModified": "2023-10-25",
  "datePublished": "2023-11-14"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

